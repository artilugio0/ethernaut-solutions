pragma solidity 0.8.19;

import "forge-std/Test.sol";
import "src/GatekeeperThree.sol";
import "src/Exploit.sol";

contract ExploitTest is Test {
    function test_exploit() public {
        uint256 timestamp = block.timestamp;
        GatekeeperThree g = new GatekeeperThree();

        Exploit e = new Exploit(address(g));
        vm.warp(timestamp + 1);

        e.exploit{value: 1000000000000001}();

        assertEq(g.entrant(), tx.origin);
    }
}
